{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/javascripts/compress.js","webpack:///./public/javascripts/loadUsername.js","webpack:///./public/javascripts/loadImg.js","webpack:///./public/javascripts/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","img","src","length","ratio","count","width","height","Math","sqrt","canvas","ctx","fillStyle","fillRect","nw","nh","tCanvas","j","tctx","drawImage","ndata","toDataURL","username","$","localStorage","setItem","console","log","event","undefined","getItem","alert","file","target","files","indexOf","type","split","size","this","reader","FileReader","onload","result","Image","css","hide","callback","data","_compress2","default","complete","readAsDataURL","_compress","click","backgroundColor","zIndex","display","document","getElementById","addEventListener","loadUsername","loadImg"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","export default function compress(img) {\r\n    var initSize = img.src.length;\r\n    var width = img.width;\r\n    var height = img.height;\r\n    //如果图片大于四百万像素，计算压缩比并将大小压至400万以下\r\n    var ratio;\r\n    if ((ratio = width * height / 4000000) > 1) {\r\n        ratio = Math.sqrt(ratio);\r\n        width /= ratio;\r\n        height /= ratio;\r\n    } else {\r\n        ratio = 1;\r\n    }\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    //        铺底色\r\n    ctx.fillStyle = \"#fff\";\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    //如果图片像素大于100万则使用瓦片绘制\r\n    var count;\r\n    if ((count = width * height / 1000000) > 1) {\r\n        count = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片\r\n        //            计算每块瓦片的宽和高\r\n        var nw = ~~(width / count);\r\n        var nh = ~~(height / count);\r\n        tCanvas.width = nw;\r\n        tCanvas.height = nh;\r\n        for (var i = 0; i < count; i++) {\r\n            for (var j = 0; j < count; j++) {\r\n                tctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\r\n                ctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\r\n            }\r\n        }\r\n    } else {\r\n        ctx.drawImage(img, 0, 0, width, height);\r\n    }\r\n    //进行最小压缩\r\n    var ndata = canvas.toDataURL('image/jpeg', 0.1);\r\n    tCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\r\n    return ndata;\r\n}","export default function loadUsername(){\r\n    const username = $('#username')[0].value;\r\n    localStorage.setItem('username', username);\r\n    console.log(localStorage);\r\n}","import compress from './compress.js';\r\n\r\nexport default function loadImg(event) {\r\n    if(localStorage.getItem('username') == undefined){\r\n        alert('请先输入名字');\r\n        return;\r\n    }\r\n    // 获取当前选中的文件\r\n    const file = event.target.files[0];\r\n    const maxsize = 10000 * 1024;\r\n    const uploadmax = 100 * 1024;\r\n    // 检查文件类型\r\n    if (['jpeg', 'png', 'gif', 'jpg'].indexOf(file.type.split(\"/\")[1]) < 0) {\r\n        alert(\"文件格式不对\");\r\n        return;\r\n    }\r\n    // 文件大小限制\r\n    if (file.size > maxsize) {\r\n        alert(\"文件过大\");\r\n        return;\r\n    }\r\n    if (!this.files.length) return;\r\n    var reader = new FileReader();\r\n    var size = file.size / 1024 > 1024 ? (~~(10 * file.size / 1024 / 1024)) / 10 + \"MB\" : ~~(file.size / 1024) + \"KB\";\r\n    reader.onload = function() {\r\n        var result = this.result;\r\n        var img = new Image();\r\n        img.src = result;\r\n        $('.photoinput').css(\"background-image\", \"url(\" + result + \")\");\r\n        $('.cameraContainer').hide();\r\n        $('.add').hide();\r\n        //如果图片大小小于100kb，则直接上传\r\n        if (result.length <= uploadmax) {\r\n            img = null;\r\n            localStorage.setItem('img', result);\r\n            return;\r\n        }\r\n        //      图片加载完毕之后进行压缩，然后上传\r\n        if (img.complete) {\r\n            callback();\r\n        } else {\r\n            img.onload = callback;\r\n        }\r\n\r\n        function callback() {\r\n            var data = compress(img);\r\n            localStorage.setItem('img', data);\r\n            var name = localStorage.getItem('username');\r\n            // $.ajax({\r\n            //     url: 'http://n5vssq.natappfree.cc/u/upload',\r\n            //     type: 'POST',\r\n            //     data: {\r\n            //         b64f : data,\r\n            //         name: name\r\n            //     }\r\n            // })\r\n            // .done(function() {\r\n            //     console.log(\"success\");\r\n            // })\r\n            // .fail(function() {\r\n            //     console.log(\"error\");\r\n            // })\r\n            // .always(function() {\r\n            //     console.log(\"complete\");\r\n            // });\r\n            img = null;\r\n        }\r\n    };\r\n    reader.readAsDataURL(file);\r\n}","import compress from './compress.js'\r\nimport loadImg from './loadImg.js'\r\nimport loadUsername from './loadUsername.js'\r\n\r\n\r\n\r\n$('.members').click(function(event) {\r\n    $('.black').css({\r\n        backgroundColor: 'rgba(0,0,0,0.7)',\r\n        zIndex: '10000'\r\n    });\r\n    $('.membersContainer').css({\r\n        display: 'block'\r\n    });\r\n});\r\n\r\n$('.close').click(function(event) {\r\n    $('.membersContainer').css({\r\n        display: 'none'\r\n    });\r\n    $('.black').css({\r\n        backgroundColor: 'rgba(0,0,0,0)',\r\n        zIndex: '-1'\r\n    });\r\n});\r\n\r\n\r\n\r\n// function getUserinfo() {\r\n//     var myUrl = encodeURI('https://wx.idsbllp.cn/nodejs/graduationSeason/');\r\n//     var apiUrl = 'https://wx.idsbllp.cn/MagicLoop/index.php?s=/addon/Api/Api/oauth&redirect=';\r\n//     var nickname;\r\n//     var headimgurl;\r\n//     if((localStorage.getItem('nickname') == undefined) && (localStorage.getItem('headimgurl') == undefined)){\r\n//         window.location = apiUrl + myUrl;\r\n//         nickname = getQueryString(nickname);\r\n//         headimgurl = getQueryString(headimgurl);\r\n//         localStorage.setItem('nickname', nickname);\r\n//         localStorage.setItem('headimgurl', headimgurl);\r\n//     } else {\r\n//         nickname = localStorage.getItem('nickname');\r\n//         headimgurl = localStorage.getItem('headimgurl');\r\n//     }\r\n    \r\n// }\r\n\r\n// function getQueryString(name) {\r\n//     var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');\r\n//     var r = window.location.search.substr(1).match(reg);\r\n//     if (r != null) {\r\n//         return unescape(r[2]);\r\n//     }\r\n//     return null;\r\n// }\r\n\r\n\r\n\r\n// window.onload = getUserinfo();\r\ndocument.getElementById('username').addEventListener('change', loadUsername)\r\ndocument.getElementById('camera_image').addEventListener('change', loadImg)"],"sourceRoot":""}